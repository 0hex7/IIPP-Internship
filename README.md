
# Enhancing Tpot-CE honeypot with MITRE Engage Goal: 'Affect'

## Overview

### Introduction

Welcome to the detailed documentation of the 3-month internship at NYCU AI College in Taiwan, where the main focus was on Active Defense implementation in Tpot CE Honeypot. 
This research work was conducted in ANT Lab starting from September 1 2023, under the guidance of **Professor. Ren-Hung Hwang**, Dean of AI College, NYCU.

### Background

NYCU AI College's commitment to cutting-edge research provided a stimulating environment. This internship delved into advanced cybersecurity strategies, with a specific focus on SSH honeypot actions and the 'Affect' goal from MITRE Engage.

## Goals

1. **Month 1: MITRE Engage Study and Honeypot Exposure**
   - Conduct an in-depth study of MITRE Engage documents, specifically focusing on the 'Affect' goal.
   - Selection of specific actions under 'Affect' goal for subsequent implementation.

2. **Month 2: Study SSH Honeypots and Choose a Honeypot for Implementation**
   - In-depth study of various SSH honeypots available in the cybersecurity landscape.
   - Choose one honeypot for implementation in the Tpot CE Honeypot.
   - Further refinement of selected actions for implementation.

3. **Month 3: Implement 4 Activities**
   - Implement the chosen SSH honeypot within the Tpot CE Honeypot.
   - Develop and execute the Lures activity by configuring the honeypot to create deceptive pathways.
   - Implement the proactive defense mechanism for the Baseline activity using Python code.
   - Set up a postfix email server for the Email Manipulation activity and integrate Suricata rules.
   - Achieve Attack Vector Migration by isolating and analyzing potential malicious email attachments.

## Monthly Work Breakdown

### Month 1: MITRE Engage Study and Honeypot Exposure

- **MITRE Engage Study**
  - Detailed analysis of specific actions under the 'Affect' goal.
  - Documentation of selected 'Affect' goal actions for future implementation.


### Month 2: Study SSH Honeypots and Choose Implementation

- **SSH Honeypot Study**
  - In-depth study of various SSH honeypots, considering features, community support, and suitability for integration with Tpot CE Honeypot.
  - Selection of one SSH honeypot for further implementation.

- **Action Refinement**
  - Further refinement of selected actions based on the chosen SSH honeypot's capabilities.

### Month 3: Implement 4 Activities from Affect goal

- **Honeypot Implementation**
  - Integration of the chosen SSH honeypot within the Tpot CE Honeypot environment.

- **Lures Activity**
  - Configuration of the chosen honeypot to simulate an attacker's traversal through deceptive pathways.

- **Baseline Activity**
  - Development and implementation of a proactive defense mechanism using Python code.

- **Email Manipulation Activity**
  - Setup of a postfix email server, acquisition of a domain at no-ip.com, and integration of Suricata rules for effective threat detection in incoming emails.

- **Attack Vector Migration**
  - Isolation of potential malicious email attachments in a separate environment for thorough analysis.

## Tools Used

### Cybersecurity Tools

1. **Suricata IDS**
   - Deployment for real-time intrusion detection.
   - Enhancement of the ability to capture and analyze malicious activities.

2. **Kibana**
   - Utilized for log analysis, intrusion detection, and vulnerability detection.

3. **Postfix Email Server**
   - Set up to facilitate the Email Manipulation activity and enable the analysis of malicious content in emails.

### Honeypot Tools

1. **Tpot CE Honeypot**
   - Core honeypot used for exposing and analyzing potential threats.

2. **SSH Honeypot inside Tpot CE honeypot Environment**
   - Integrated within Tpot for comprehensive SSH honeypot capabilities.

## Implementation Details

### Month 3: Email Manipulation and Attack Vector Migration

- **Lures Activity Implementation**
  - Postfix email server setup and configuration.
  - Acquisition of a domain at no-ip.com for realistic email scenarios.
  - Integration of Suricata rules for enhanced threat detection.

- **Baseline Activity Implementation**
  - Isolation of potential malicious email attachments.
  - Detailed documentation of the separate environment for analysis.

- **Email Manipulation Activity Implementation**
  - Postfix email server setup and configuration.
  - Acquisition of a domain at no-ip.com for realistic email scenarios.
  - Integration of Suricata rules for enhanced threat detection.

- **Attack Vector Migration Implementation**
  - Isolation of potential malicious email attachments.
  - Detailed documentation of the separate environment for analysis.

## Research Findings

### Advanced Cybersecurity Strategies

#### 'DECEPTIVE DECOYS: Combining Believable User and Network Activities'

- Emphasis on combining believable user and network activities for creating effective deceptive decoys.
- Direct impact on the implementation of the Lures activity, ensuring realistic traps for potential attackers.

#### 'Hackers Came, But the French Were Prepared'

- Insights into proactive defense mechanisms demonstrated in countering potential threats.
- Direct influence on the development of the proactive defense mechanism in the Baseline activity.

## IIPP Report Integration

### Gains and Experiences

- **Month 1**
  - Introduction to advanced cybersecurity concepts and MITRE Engage goals.

- **Month 2**
  - Deepened understanding of SSH honeypots and selection for implementation.

- **Month 3**
  - Practical implementation of chosen honeypot and execution of multiple cybersecurity activities.

### Life in Taiwan

- **Cultural Experience**
  - Immersive experience in Taiwan's vibrant culture.

- **Collaborative Atmosphere**
  - Dynamic learning environment at NYCU AI College.

## GitHub Repository Structure

### Code

- **/month1_mitre_engage_study**: Documents related to the MITRE Engage study and action selection.
- **/month1_honeypot_exposure**: Configuration details for Tpot CE Honeypot exposure.

- **/month2_ssh_honeypot_study**: Documentation on the study of SSH honeypots and the chosen implementation.

- **/month3_honeypot_implementation**: Code and configurations for integrating the chosen SSH honeypot within Tpot CE Honeypot.
- **/month3_lures_activity**: Cowrie honeypot configuration and file system alteration.
- **/month3_baseline_activity**: Python scripts and documentation for the proactive defense mechanism.
- **/month3_email_manipulation**: Postfix email server setup and configuration.
- **/month3_attack_vector_migration**: Documentation and analysis of isolated email attachments.

### Documentation

- **/research_papers**: Detailed summaries and insights from relevant research papers.
- **/iipp_report**: Integrated content from the IIPP report.

### Resources

- **/tools_used**: Additional resources on the tools used during the internship.

## Acknowledgments

I express sincere gratitude to Professor Ren-Hung Hwang for exceptional mentorship, guidance, and continuous support throughout the 3-month internship. Special thanks to colleagues at the ANT Lab for their collaboration and insights that significantly enriched the overall experience.

